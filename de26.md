<details>
<summary>1 модуль</summary>

---

<details>
<summary>ISP</summary>

---

```
hostnamectl hostname isp; exec bash
mkdir /etc/net/ifaces/ens20
mkdir /etc/net/ifaces/ens21
mkdir /etc/net/ifaces/ens22
vim /etc/net/ifaces/ens20/options
	DISABLED=no
	TYPE=eth
	BOOTPOROTO=static
	CONFIG_IPV4=yes
cp /etc/net/ifaces/ens20/options /etc/net/ifaces/ens21
cp /etc/net/ifaces/ens20/options /etc/net/ifaces/ens22
vim /etc/net/ifaces/ens20/options
	BOOTPROTO=dhcp
echo 172.16.1.1/28 > /etc/net/ifaces/ens21/ipv4address
echo 172.16.2.1/28 > /etc/net/ifaces/ens22/ipv4address
vim /etc/net/sysctl.conf
	net.ipv4.ip_forward = 0
systemctl restart network
apt-get update && apt-get install iptables -y && apt-get reinstall tzdata -y
timedatectl set-timezone Asia/Yekaterinburg
iptables -t nat -A POSTROUTING -o ens20 -s 0/0 -j MASQUERADE
iptables-save > /etc/sysconfig/iptables
systemctl enable --now iptables
```

</details>

---

<details>
<summary>HQ-RTR</summary>

```
hostname hq-rtr
ip domain-name au-team.irpo
ntp timezone utc+5
username net_admin
	role admin
	password P@ssw0rd
exit
port te0
	service-instance te0/int0
	encapsulation untagged
	exit
exit
port te1
	service-instance te1/int1
		encapsulation dot1q 100
		rewrite pop 1
		exit
	service-instance te1/int2
		encapsulation dot1q 200
		rewrite pop 1
		exit
	service-instance te1/int3
		encapsulation dot1q 999
		rewrite pop 1
		exit
	exit
int int0
	ip address 172.16.1.2/28
	ip nat outside
	connect port te0 service-instance te0/int0
	exit
int int1
	ip address 192.168.1.1/27
	ip nat inside
	connect port te1 service-instance te1/int1
	exit
int int2
	ip address 192.168.2.1/28
	ip nat inside
	connect port te1 service-instance te1/int2
	exit
int int3
	ip address 192.168.99.1/29
	connect port te1 service-instance te1/int3
	exit
int tunnel.0
	ip address 172.16.0.1/30
	ip mtu 1400
	ip tunnel 172.16.1.2 172.16.2.2 mode gre
	ip ospf authentication-key ecorouter
	exit
router ospf 1
	network 172.16.0.0/30 area 0
	network 192.168.1.0/27 area 0
	network 192.168.2.0/28 area 0
	passive-interface default
	no passive-interface tunnel.0
	area 0 authentication
	exit
ip route 0.0.0.0 0.0.0.0 172.16.1.1
ip nat pool NAT_POOL 192.168.1.1-192.168.1.254,192.168.2.1-192.168.2.254
ip nat source dynamic inside-to-outside pool NAT_POOL overload int int0
ip pool cli_pool 192.168.2.10-192.168.2.10
	dhcp-server 1
		pool cli_pool 1
		mask 255.255.255.240
		gateway 192.168.2.1
		dns 192.168.1.10
		domain-name au-team.irpo
		exit
	exit
int int2
	dhcp-server 1
	exit
write
write
```

</details>

---

<details>
<summary>BR-RTR</summary>

---

```
hostname BR-RTR
ip domain-name au-team.irpo
ntp timezone utc+5
username net_admin
	role admin
	password P@ssw0rd
	exit
port te0
	service-instance te0/int0
		encapsulation untagged
		exit
	exit
port te1
	service-instance te1/int1
		encapsulation untagged
		exit
	exit
int int0
	ip address 172.16.2.2/28
	ip nat outside
	connect port te0 service-instance te0/int0
	exit
int int1
	ip address 192.168.3.1/28
	ip nat inside
	connect port te1 service-instance te1/int1
	exit
int tunnel.0
	ip address 172.16.0.2/30
	ip mtu 1400
	ip tunnel 172.16.2.2 172.16.1.2 mode gre
	ip ospf authentication-key ecorouter
	exit
router ospf 1
	network 172.16.0.0/30 area 0
	network 192.168.3.0/28 area 0
	passive-interface default
	no passive-interface tunnel.0
	area 0 authentication
	exit
ip route 0.0.0.0 0.0.0.0 172.16.2.1
ip nat pool NAT_POOL 192.168.3.1-192.168.3.254
ip nat source dynamic inside-to-outside pool NAT_POOL overload int int0
write
write
```

</details>

---

<details>
<summary>HQ-SRV</summary>

---

```
hostnamectl hostname hq-srv.au-team.irpo; exec bash
timedatectl set-timezone Asia/Yekaterinburg
adduser sshuser -u 2026
passwd sshuser
visudo
# WHEEL_USERS ALL=(ALL:ALL) NOPASSWD: ALL/ WHEEL_USERS ALL=(ALL:ALL) NOPASSWD: ALL
gpasswd -a "sshuser" wheel
echo Authorized access only > /etc/openssh/banner
vim /etc/openssh/sshd_config
	Port 2026
	AllowUsers sshuser
	MaxAuthTries 2
	PasswordAuthentication yes
	Banner /etc/openssh/banner
systemctl restart sshd
mkdir /etc/net/ifaces/ens20
vim /etc/net/ifaces/ens20/options
	DISABLED=no
	TYPE=eth
	BOOTPROTO=static
	CONFIG_IPV4=yes
echo 192.168.1.10/27 > /etc/net/ifaces/ens20/ipv4address
echo default via 192.168.1.1 > /etc/net/ifaces/ens20/ipv4route
echo nameserver 8.8.8.8 > /etc/resolv.conf
systemctl restart network
apt-get update && apt-get install dnsmasq -y
vim /etc/dnsmasq.conf
	no-resolv
	domain=au-team.irpo
	server=8.8.8.8
	interface=*
	address=/hq-rtr.au-team.irpo/192.168.1.1
	ptr-record=1.1.168.192.in-addr.arpa,hq-rtr.au-team.irpo
	address=/docker.au-team.irpo/172.16.1.1
	address=/web.au-team.irpo/172.16.2.1
	address=/br-rtr.au-team.irpo/192.168.3.1
	address=/hq-srv.au-team.irpo/192.168.1.10
	ptr-record=10.1.168.192.in-addr.arpa,hq-srv.au-team.irpo
	address=/hq-cli.au-team.irpo/192.168.2.10
	ptr-record=10.2.168.192.in-addr.arpa,hq-cli.au-team.irpo
	address=/br-srv.au-team.irpo/192.168.3.10
vim /etc/hosts
	192.168.1.1	hq-rtr.au-team.irpo
systemctl enable --now dnsmasq
systemctl restart dnsmasq
```

</details>

---

<details>
<summary>BR-SRV</summary>

---

```
hostnamectl hostname br-srv.au-team.irpo; exec bash
timedatectl set-timezone Asia/Yekaterinburg
adduser sshuser -u 2026
passwd sshuser
visudo
# WHEEL_USERS ALL=(ALL:ALL) NOPASSWD: ALL/ WHEEL_USERS ALL=(ALL:ALL) NOPASSWD: ALL
gpasswd -a "sshuser" wheel
echo Authorized access only > /etc/openssh/banner
vim /etc/openssh/sshd_config
	Port 2026
	AllowUsers sshuser
	MaxAuthTries 2
	PasswordAuthentication yes
	Banner /etc/openssh/banner
systemctl restart sshd
mkdir /etc/net/ifaces/ens20
vim /etc/net/ifaces/ens20/options
	DISABLED=no
	TYPE=eth
	BOOTPROTO=static
	CONFIG_IPV4=yes
echo 192.168.3.10/28 > /etc/net/ifaces/ens20/ipv4address
echo default via 192.168.3.1 > /etc/net/ifaces/ens20/ipv4route
echo nameserver 192.168.1.10 > /etc/resolv.conf
systemctl restart network
apt-get update
```

</details>

---

<details>
<summary>HQ-CLI</summary>

---

```
hostnamectl hostname hq-cli.au-team.irpo; exec bash
timedatectl set-timezone Asia/Yekaterinburg
mkdir /etc/net/ifaces/ens20
vim /etc/net/ifaces/ens20/options
	TYPE=eth
	BOOTPROTO=dhcp
systemctl restart network
apt-get update
```

</details>

</details>

---

<details>
<summary>2 модуль</summary>

---

<details>
<summary>HQ-SRV</summary>

---

```
vim /etc/dnsmasq
ᅠ ᅠᅠ ᅠserver=/au-team.irpo/192.168.3.10
systemctl restart dnsmasq
```
<img width="745" height="359" alt="creating_disks" src="https://github.com/user-attachments/assets/7bd007fd-2d5a-4a95-be9a-b5e669585a96" />
```
lsblk
```
<img width="372" height="131" alt="check_disks" src="https://github.com/user-attachments/assets/2f663744-5399-4924-9b29-19179cd98385" />
```
mdadm --create /dev/md0 --level=0 --raid-devices=2 /dev/sd[b-c]
mdadm --detail -scan --verbose > /etc/mdadm.conf
apt-get update && apt-get install fdisk nfs-server -y
fdisk /dev/md0
```
<img width="1116" height="748" alt="options_raid" src="https://github.com/user-attachments/assets/6ad65ab6-325d-48ea-b05f-49306cfb007e" />
```
mkfs.ext4 /dev/md0p1
vim/etc/fstab
	/dev/md0p1		/raid		ext4		defaults		0		0
mkdir /raid
mount -a
mkdir /raid/nfs
chown 99:99 /raid/nfs
chmod 777 /raid/nfs
vim /etc/exports
	/raid/nfs 192.168.2.0/28(rw,sync,no_subtree_check)
exportfs -a
exportfs -v
systemctl enable --now nfs
systemctl restart nfs

apt-get install chrony -y
vim /etc/chrony.conf
	(all delete)
	server 172.16.1.1 iburst prefer
systemctl enable --now chronyd
chronyc sources
timedatectl



apt-get install lamp-server -y
mount -o loop /dev/sr0
cp /media/ALTLinux/web/index.php /var/www/html
cp /media/ALTLinux/web/logo.png /var/www/html
vim /www/html/index.php
	$servername = "localhost";
	$username = "webc";
	$password = "P@ssw0rd";
	$dbname = "webdb";
systemctl enable --now mariadb
mariadb -u root
	CREATE DATABASE webdb;
	CREATE USER 'webc'@'localhost' IDENTIFIED BY 'P@ssw0rd';
	GRANT ALL PRIVILEGES ON webdb.* TO 'webc'@'localhost';
	FLUSH PRIVILEGES;
	exit
mariadb -u root -D webdb < /media/ALTLinux/web/dump.sql
systemctl enable --now httpd2
```






<details>
<summary>BR-SRV</summary>

---

```
apt-get update && apt-get install task-samba-dc -y
vim /etc/resolv.conf
	nameserver 192.168.1.10
rm -rf /etc/samba/smb.conf
vim /etc/hosts
	192.168.3.10 br-srv.au-team.irpo
samba-tool domain provision
mv -f /var/lib/samba/private/krb5.conf /etc/krb5.conf
systemctl eanble --now samba
samba-tool user add hquser1 P@ssw0rd
samba-tool user add hquser2 P@ssw0rd
samba-tool user add hquser3 P@ssw0rd
samba-tool user add hquser4 P@ssw0rd
samba-tool user add hquser5 P@ssw0rd
samba-tool group add hq
samba-tool group addmembers hq hquser1,hquser2,hquser3,hquser4,hquser5
apt-repo add rpm http://altrepo.ru/local-p10 noarch local-p10
apt-get update && apt-get install sudo-samba-schema -y
sudo-schema-apply
	(da)
	(Administrator P@ssw0rd)
	(da)
create-sudo-rule
```
<img width="691" height="519" alt="createing_rule" src="https://github.com/user-attachments/assets/f846658e-5e80-40a9-b502-1731669da2e7" />
```




apt-get install chrony -y
vim /etc/chrony.conf
	server 172.16.2.1 iburst prefer
systemctl eanble --now chronyd
chronyc sources
timedatectl

apt-get install ansible -y
vim /etc/ansible/hosts
	[servers]
	HQ-SRV ansible_host=192.168.1.10
	HQ-CLI ansible_host=192.168.2.10
	[servers:vars]
	ansible_user=sshuser
	ansible_port=2026
	[routers]
	HQ-RTR ansible_host=192.168.1.1
	BR-RTR ansible_host=192.168.3.1
	[routers:vars]
	ansible_user=net_admin
	ansible_password=P@ssw0rd
	ansible_connection=network_cli
	ansible_network_os=ios
vim /etc/ansible/ansible.cfg
	[defaults]
	interpreter_python=auto_silent
ssh-keygen -t rsa
ssh-copy-id -p 2026 sshuser@192.168.1.10
ssh-copy-id -p 2026 sshuser@192.168.2.10
ansible all -m ping






local (AltPVE) > ISO Images > Upload > File > Upload

Hardware > Add > CD/DVD Drive > Storage: local; ISO image: Additional.iso > Add

apt-get install docker-compose docker-engine-v2 -y
systemctl enable --now docker

mount -o loop /dev/sr0 /mnt/
docker load < /mnt/docker/site_latest.tar
docker load < /mnt/docker/mariadb_latest.tar
docker images
vim docker-compose.yml
	services:
		db:
			image: mariadb
			container_name: db
			environment:
				MARIADB_ROOT_PASSWORD: "P@ssw0rd"
				MARIADB_DATABASE: "testdb"
				MARIADB_USER: "test"
				MARIADB_PASSWORD: "P@ssw0rd"
			restart: always
		testapp:
			image: site
			container_name: testapp
			environment:
				DB_TYPE: "maria"
				DB_HOST: "db"
				DB_NAME: "testdb"
				DB_USER: "test"
				DB_PASS: "P@ssw0rd"
				DB_PORT: "3306"
			ports:
				- "8080:8000"
			depends_on:
				- db
			restart: always
docker compose up -d
```












